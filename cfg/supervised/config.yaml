robot_name: 'bolt'
# TODO: Make distinctions between. Trainer Args, Model Psecific Args, Program Args
model_type: 'emlp'
init_mode: 'fan_in'   # Forward constant activation variance or cnst gradient backward variance.
bias: false
lr: 1e-3
lr_trials: 50
num_layers: 1
num_channels: 64
seed: -1
batch_size: 512

exp_name: 'tests'
device: 0
max_epochs: 2

# Run parameters
run_type: single_run
kfolds: 5

dataset:
  name: 'com_momentum'
  train_samples: 5000
  test_samples: 10000
  angular_momentum: True
  standarize: True
  augmentation: False

# Hydra configuration _________
#defaults:
#  - override hydra/launcher: joblib

hydra:
  run:
    dir: ./experiments/${hydra.job.name}/${hydra.job.override_dirname}

  job:
    # TODO: Reorganize output dir
    name: ${exp_name}_${robot_name}/train=${dataset.train_samples}-test=${dataset.test_samples}/model=${model_type}_n-ch${num_channels}_n-ly${num_layers}
    num: ${seed}
    env_set:
      XLA_PYTHON_CLIENT_PREALLOCATE: 'false'
      HYDRA_FULL_ERROR: '1'
    config:
      override_dirname:
        kv_sep: "="
        item_sep: " "
        exclude_keys:
          - seed
          - batch_size
          - model_type
          - num_channels
          - num_layers
          - device
          - robot_name
          - exp_name
          - max_epochs
          - dataset.train_samples
          - dataset.val_samples
          - dataset.test_samples
          - run_type
          - kfolds

  sweep:
    dir: ./experiments/${hydra.job.name}/
    subdir: ${hydra.job.override_dirname}

  job_logging:
    version: 1
    colorlog: True
    formatters:
      simple:
        format: '[%(levelname)s][%(name)s] %(message)s'
    handlers:
      console:
        class: logging.StreamHandler
        formatter: simple
        stream: ext://sys.stdout
      file:
        class: logging.handlers.RotatingFileHandler
        formatter: simple
        filename: log.log
        maxBytes: 2048
        backupCount: 1
    root:
      handlers: [console,file]

    disable_existing_loggers: false